[TOC]



## 线段树

```
1：介绍：
    	是一种二叉搜索树。 （除最后一排节点，是一颗满二叉树）
    类似区间树，会将区间划分为一些单元区间，每个的单元区间对于线段树中的叶节点。
    
2：应用：    
    	使用线段树可以快速查找某一个节点在若干条线段中的出现次数。
```

```
常用操作：
	1：pushup
	
	2：pushdown
	
	3：build    将一段初始化为线段树
	
	4：modify   修改单点/区间
	
	5：query    查询
```

![](image/XianDuanShu.png)

**线段树的存储及开区间范围**

```c++
存储：
    满二叉树的结构，类似于 堆。所以使用 一维数组来存储二叉树。
    
    存储原则：
    当前节点编号为 x ,那么
    		父节点：x/2 ,    (x >> 1)
    		左子节点：2x ,   (x << 1)
    		右子节点：2x+1   (x << 1 | 1)
    
长度为 n 的区间形成的线段树，节点数目：
    次最后一层节点最坏会有 n 个节点，那么除最后一层节点外总共大概有 2n-1 个节点
    而最后一层最多是 有 2n 个节点，所以大概就会有  4n 个节点
即：通常会开 4n 的空间存储线段树，避免越界。
      
```

```
查询过程：
	[L,R] 是指要查询的区间。    [tl,tr]指的是当前向下查询时遇到的 叶子区间。
 步骤：
 	1： [L,R] 包含 [tl，tr]
 	2： [L,R] 和 [tl,tr] 有交集，和哪边有交集就会像哪边递归，两边同时有交集就会像两边递归。
 	3： 不会出现没有交集：
 			因为我们从根节点开始向下递归查询，并且每一次都是在向有交集的节点递归。
 			所以不会出现没有交集的情况
 			
访问区间的时间复杂度 是在 o(logn)之内


```

```
动态的修改区间中的某个数。
动态的查询某个区间的最大值。

1：添加操作：
	每次动态的添加会带来比较大的开销，所以我们初始化所有的区间。（将动态的操作改为静态的操作）
	将每一次的添加操作转换为 修改操作。修改完之后，标记 n+1 这个位置被修改（证明已添加）
2：求某个区间的最大值
	[n-L+1 , n] 区间中的最大值。

```

**线段树节点的存储**

```
	线段树的节点一般由结构体来存。
	
结构体中要存储的属性一般会有：
	1：左右端点。
	2：可以通过左右节点中属性信息的叠加来算出两者父节点的某些属性 的属型。
	
如何判断线段树地节点中应该存储的属性：
	通过线段树要解决的问题可能是 求某个区间的某种属性。
	1：首先是 这种属性。
	2：其次是附加属性。（是由左右子节点中的属性信息能不能算出父节点的这个属性决定的，如果不行就
						需要附加属性）
                        
```























